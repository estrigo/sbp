<!DOCTYPE html>
<html th:replace="layouts/main::main(~{::div}, ~{::script})">

link href="../plugins/datatables/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
<link href="../plugins/datatables/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />

<div>
    <table>
        <thead>
        <tr>
            <th><a th:text="#{ordinal.number}"></a></th>
            <th><a th:text="#{user.username}"></a></th>
            <th><a th:text="#{user.email}"></a></th>
            <th><a th:text="#{user.first.name}"></a></th>
            <th><a th:text="#{user.last.name}"></a></th>
            <th><a th:text="#{role.id}"></a></th>
            <th><a th:text="#{role.name}"></a></th>
            <th></th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user, iterStat : ${users}">
            <td th:text="${iterStat.count}"></td>
            <td th:text="${user.username}"></td>
            <td th:text="${user.email}"></td>
            <td th:text="${user.firstName}"></td>
            <td th:text="${user.lastName}"></td>
            <td th:text="${user.role.id}"></td>
            <td th:text="${user.role.name}"></td>
            <p sec:authorize="hasAnyRole('ROLE_USER', 'ROLE_MANAGER')">
            <td><a th:if="${currentUser.equals(user)}" th:href="@{|/user/edit/${user.id}|}">Edit</a></td>
            </p>
            <p sec:authorize="hasAnyRole('ROLE_OWNER', 'ROLE_ADMIN')">
            <td><a th:href="@{|/user/edit/${user.id}|}">Edit</a></td>
            </p>
            <p sec:authorize="hasRole('ROLE_ADMIN')">
            <td><a th:unless="${currentUser.equals(user)}" th:href="@{|/user/delete/${user.id}|}">Delete</a></td>
            </p>
        </tr>
        </tbody>
    </table>

    <p><a th:href="@{|/download.pdf|}" th:text="'Download users list in PDF file'"></a></p>
    <p><a th:href="@{|/download.xls|}" th:text="'Download users list in XLS file'"></a></p>
    <p><a th:href="@{|/download.csv|}" th:text="'Download users list in CSV file'"></a></p>
</div>

<script src="plugins/datatables/jquery.dataTables.min.js"></script>
<script src="plugins/datatables/dataTables.bootstrap4.min.js"></script>

<script type="text/javascript">
    $(document).ready(function() {
        $('#datatable').DataTable();

        //Buttons examples
        var table = $('#datatable-buttons').DataTable({
            lengthChange: false,
            buttons: ['copy', 'excel', 'pdf', 'colvis']
        });

        table.buttons().container()
            .appendTo('#datatable-buttons_wrapper .col-md-6:eq(0)');
    } );

</script>

</html>
